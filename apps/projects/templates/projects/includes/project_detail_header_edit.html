{% load i18n %}
{# Edit mode for project detail header - form inputs for inline editing #}
<div id="project-header"
     class="project-detail-header-edit bg-base-200 rounded-lg p-4"
     x-data
     @keydown.escape="htmx.ajax('GET', '{% url 'projects:project_detail_inline_edit' workspace.slug project.key %}?cancel=1', { target: $el, swap: 'outerHTML' })">
  <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

  <div class="flex justify-between items-start mb-4">
    <div class="flex-1">
      <div class="flex items-center gap-2 mb-2">
        <span class="font-mono text-sm text-gray-500">{{ project.key }}</span>
      </div>
      <input type="text"
             name="name"
             value="{{ project.name }}"
             class="input input-bordered w-full text-xl font-bold {% if form.name.errors %}input-error{% endif %}"
             placeholder="{% translate 'Project name' %}"
             required
             autofocus>
      {% if form.name.errors %}
      <span class="text-error text-xs">{{ form.name.errors.0 }}</span>
      {% endif %}
    </div>
  </div>

  <div class="mb-4">
    <h3 class="font-semibold mb-2">{% translate "Description" %}</h3>
    <textarea name="description"
              class="textarea textarea-bordered w-full {% if form.description.errors %}textarea-error{% endif %}"
              rows="3"
              placeholder="{% translate 'Add a description...' %}">{{ project.description }}</textarea>
    {% if form.description.errors %}
    <span class="text-error text-xs">{{ form.description.errors.0 }}</span>
    {% endif %}
  </div>

  {# Project fields - 2-column layout #}
  <div class="grid grid-cols-2 gap-4 mb-4">
    <div>
      <h3 class="font-semibold mb-1 text-sm text-gray-500">{% translate "Status" %}</h3>
      <select name="status"
              class="select select-bordered select-sm w-full {% if form.status.errors %}select-error{% endif %}">
        {% for value, label in status_choices %}
        <option value="{{ value }}" {% if project.status == value %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
      {% if form.status.errors %}
      <span class="text-error text-xs">{{ form.status.errors.0 }}</span>
      {% endif %}
    </div>
    <div>
      <h3 class="font-semibold mb-1 text-sm text-gray-500">{% translate "Lead" %}</h3>
      {% include "includes/user_combobox.html" with combobox_name="lead" combobox_members=workspace_members combobox_selected_id=project.lead_id|default:"" combobox_selected_name=project.lead.get_display_name|default:"" combobox_size="sm" %}
    </div>
  </div>

  <div class="flex gap-2">
    <button type="button"
            class="btn btn-success"
            hx-post="{% url 'projects:project_detail_inline_edit' workspace.slug project.key %}"
            hx-include="#project-header"
            hx-target="#project-header"
            hx-swap="outerHTML">
      <i class="fa fa-check"></i> {% translate "Save" %}
    </button>
    <button type="button"
            class="btn btn-ghost"
            hx-get="{% url 'projects:project_detail_inline_edit' workspace.slug project.key %}?cancel=1"
            hx-target="#project-header"
            hx-swap="outerHTML">
      <i class="fa fa-times"></i> {% translate "Cancel" %}
    </button>
  </div>
</div>
